package org.example;

/*

    В ИТМО действует балльно-рейтинговая система, согласно которой итоговая оценка по дисциплине за семестр определяется по сумме баллов, набранной в течение семестра и на сессии.
    Для поддержки работы этой системы разработан электронный журнал, где преподаватели могут выставлять баллы, а студенты смотреть их.

    Журнал работает следующим образом: для каждой дисциплины и для каждой группы строится таблица с баллами,
        где каждый столбец — это определённая контрольная точка, за которую выставляется свой балл,
        а каждая строка показывает баллы конкретного студента.
    Гарантируется, что сумма баллов, которую можно получить за семестр по всем контрольным точкам, не превышает 100,
        но не гарантируется, что в любой момент каждому студенту будут выставлены баллы за каждую контрольную точку.

    Пример такой таблицы:
    Табельный номер	ЛР 1 (15)	ЛР 2 (20)	ЛР 3 (25)	Тестирование (15)	Экзамен (25)	Итого
    114568	15	14		12	15	56
    116501						0
    224857	11	17	24	9	20	81
    334792	15	20	25	15	25	100

    Здесь в скобках указан максимальный балл, который можно поставить за контрольную точку.
    Обратите внимание, что столбец "Итого" не является контрольной точкой.
    Сам журнал хранит только баллы, но не позволяет, например, проводить тестирования.
    Этим занимаются другие команды разработчиков, которые позже интегрируют свои решения, выставляя баллы с использованием API журнала.
    Иногда разработчики сторонних интеграций пытаются нарушить работу журнала, выставляя некорректные баллы, поэтому во время выставления баллов через API нужно проверять полученные баллы на корректность.
    Балл студента за контрольную точку является корректным, если он неотрицателен и не превышает максимальный балл за выбранную контрольную точку.
    Если балл не выставлен, то он считается корректным.

    Попробуйте по заданному набору выставляемых в журнал баллов определить, есть ли в нём ошибки или нет, и выведите информацию о найденных ошибках.

    Формат ввода
    В первой строке входных данных даётся два целых положительных числа N и K — количество контрольных точек по дисциплине и количество студентов в группе (0<N≤50;0<K≤200).
    Во второй строке входных данных даётся N положительных целых чисел M1, M2, …, MN — максимальный балл за каждую контрольную точку (Σ от N где i=1 = 100).
    В следующих K строках содержится N+1 число: табельный номер студента ID (100000≤ID≤999999)
        и баллы за каждую контрольную точку PIDi в том порядке, в котором они указаны во второй строке входных данных (−10^9≤PIDi≤10^9).
    Если балл не выставлен, то в качестве PIDi ставится прочерк (-). Гарантируется, что все табельные номера в рамках группы не повторяются.

    Формат вывода
    В первой строке выходных данных выведите число E — количество ошибок, содержащихся в выставляемых баллах.
    В следующих K строках выведите информацию о корректности баллов следующим образом: первое число в строке должно содержать табельный номер студента ID,
        а после этого нужно вывести Y, если балл студента за контрольную точку PIDi корректен, и N в противном случае.
    В случае вопросов по формату выходных данных ориентируйтесь на примеры.

    Пример 1:
    Ввод:
    5 4
    15 20 25 15 25
    114568 15 14 - 12 15
    116501 - - - - -
    224857 11 17 24 9 20
    334792 15 20 25 15 25

    Вывод:
    0
    114568 Y Y Y Y Y
    116501 Y Y Y Y Y
    224857 Y Y Y Y Y
    334792 Y Y Y Y Y

    Пример 2:
    Ввод:
    5 4
    15 20 25 15 25
    114568 15 14 - 0 15
    116501 - - 5 - -
    224857 11 17 27 9 20
    334792 -7 20 25 15 25

    Вывод:
    2
    114568 Y Y Y Y Y
    116501 Y Y Y Y Y
    224857 Y Y N Y Y
    334792 N Y Y Y Y

    Примечания
    Первый пример соответствует таблице из условия задачи, и в нём все баллы корректны.
    Второй пример почти соответствует таблице из условия задачи за исключением следующих изменений:
    * Студенту с ID = 114568 за контрольную точку 4 выставлено 0 баллов, это корректная ситуация;
    * Студенту с ID = 116501 за контрольную точку 3 выставлено 5 баллов;
    * Студенту с ID = 224857 за контрольную точку 3 выставлено 27 баллов из 25, это некорректная ситуация;
    * Студенту с ID = 334792 за контрольную точку 1 выставлено -7 баллов, это некорректная ситуация.

 */

import java.util.Scanner;

public class ElectronicDiary {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);

        int N = scanner.nextInt(); // количество контрольных точек
        int K = scanner.nextInt(); // количество студентов

        int[] maxScores = new int[N]; // максимальные баллы за контрольные точки
        for (int i = 0; i < N; i++) {
            maxScores[i] = scanner.nextInt();
        }

        int errorCount = 0; // счётчик ошибок
        String[] info = new String[K];


        for (int j = 0; j < K; j++) {
            int studentID = scanner.nextInt(); // табельный номер студента
            boolean[] errors = new boolean[N]; // массив для хранения информации о корректности баллов

            for (int i = 0; i < N; i++) {
                String scoreStr = scanner.next();
                int score;
                if (scoreStr.equals("-")) {
                    score = 0; // если балл не выставлен, считаем его 0
                } else {
                    score = Integer.parseInt(scoreStr);
                }

                if (score < 0 || score > maxScores[i]) {
                    errors[i] = true; // балл некорректный
                    errorCount++;
                }
            }

            info[j] = studentID + " ";
            for (boolean error : errors) {
                String s = error ? "N " : "Y ";
                info[j] += s;
            }
        }

        // Выводим количество ошибок
        System.out.println(errorCount);

        // Выводим информацию о корректности баллов студента
        for (String s : info) {
            System.out.println(s);
        }
    }
}

